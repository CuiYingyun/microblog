{{ define "main" }}
  <div class="microblog-container">
    {{ $paginator := .Paginate (where .Site.RegularPages "Type" "posts") 10 }}
    {{ range $paginator.Pages }}
      <article class="microblog-post">
        <div class="prose dark:prose-invert">
          {{ .Content }}
        </div>
        <div class="post-meta text-sm text-neutral-500 dark:text-neutral-400 text-right">
          <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
            {{ .Date.Format "2006-01-02" }}
          </time>
          {{ if .Params.tags }}
            <span class="mx-2">·</span>
            {{ range $index, $tag := .Params.tags }}
              {{- if $index -}}, {{ end -}}
              <a href="{{ ($.Site.GetPage (printf "/tags/%s" .)).RelPermalink }}" class="tag">#{{ $tag }}</a>
            {{- end -}}
          {{ end }}
          <span class="mx-2">·</span>
          <button class="extend-button" data-content="{{ .RawContent | htmlEscape }}" data-title="{{ .Title | htmlEscape }}" data-date="{{ .Date.Format "2006-01-02" }}">
            ⋯
          </button>
          <div class="extend-menu hidden">
            <div class="extend-menu-item" data-action="copy-markdown">
              Copy as Markdown
            </div>
            <div class="extend-menu-item" data-action="generate-share-image">
              Generate Share Image
            </div>
          </div>
        </div>
      </article>
    {{ end }}
    
    {{/* Pagination */}}
    {{ if gt $paginator.TotalPages 1 }}
      <nav class="flex justify-between mt-8">
        <div>
          {{ if $paginator.HasPrev }}
            <a href="{{ $paginator.Prev.URL }}" class="text-neutral-900 dark:text-white">← Newer Posts</a>
          {{ end }}
        </div>
        <div>
          {{ if $paginator.HasNext }}
            <a href="{{ $paginator.Next.URL }}" class="text-neutral-900 dark:text-white">Older Posts →</a>
          {{ end }}
        </div>
      </nav>
    {{ end }}
  </div>

  {{/* Share Image Modal */}}
  <div id="share-image-modal" class="share-modal hidden">
    <div class="share-modal-overlay">
      <div class="share-modal-container">
        <div class="share-modal-header">
          <h3 class="share-modal-title">Share Image Preview</h3>
          <button class="share-modal-close">&times;</button>
        </div>
        <div class="share-modal-content">
          <div class="share-card-wrapper">
            <div id="share-card" class="share-card">
              <div class="share-card-content">
                <div class="share-article-content">
                  <!-- Article content will be inserted here -->
                </div>
              </div>
              <div class="share-card-footer">
                <div class="share-footer-info">
                  <span class="share-website">CuiYingyun.com</span>
                  <span class="share-date"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="share-modal-actions">
          <button class="share-copy-btn">Copy</button>
          <button class="share-download-btn">Download</button>
        </div>
      </div>
    </div>
  </div>
{{ end }} 